schema: '2.0'
stages:
  build_dataset:
    cmd: uv run src/build_dataset.py data/CICIDS2017_improved
    deps:
    - path: data/CICIDS2017_improved
      hash: md5
      md5: 97448ae36a9acd7110a7c6dafed93e84.dir
      size: 1152270765
      nfiles: 5
    - path: src/build_dataset.py
      hash: md5
      md5: 549c485423c2baa7e0fe91f4409c4721
      size: 5058
    params:
      params.yaml:
        dataset_name: CICIDS2017_improved
    outs:
    - path: data/test/raw
      hash: md5
      md5: d1bea5bd78a93a985bba6933d5ee4727.dir
      size: 61306713
      nfiles: 7
    - path: data/train/raw
      hash: md5
      md5: 0d3a44ba0fa58bfbd0c54533ae76194f.dir
      size: 143222048
      nfiles: 15
    - path: log/build_dataset.log
      hash: md5
      md5: b2a5d15b06d6741453b240b315444a93
      size: 435
  categorical_binary:
    cmd: uv run src/categorical_binary.py
    deps:
    - path: data/test/raw
      hash: md5
      md5: d1bea5bd78a93a985bba6933d5ee4727.dir
      size: 61306713
      nfiles: 7
    - path: data/train/raw
      hash: md5
      md5: 0d3a44ba0fa58bfbd0c54533ae76194f.dir
      size: 143222048
      nfiles: 15
    - path: src/categorical_binary.py
      hash: md5
      md5: 73fc8954c0bd85b8d12e924f180d3266
      size: 5060
    outs:
    - path: data/test/binary
      hash: md5
      md5: 2676d13c7f32cf8502d2be723d971f05.dir
      size: 62455662
      nfiles: 7
    - path: data/train/binary
      hash: md5
      md5: 6ff07edb2598c4f7347b6bcbd18788ea.dir
      size: 145907904
      nfiles: 15
    - path: log/categorical_binary.log
      hash: md5
      md5: a21bbd83d2ea5501e3ccc36f55c2b90c
      size: 1243
  train:
    cmd: uv run src/train.py data/train/raw
    deps:
    - path: data/train/raw
      hash: md5
      md5: 0d3a44ba0fa58bfbd0c54533ae76194f.dir
      size: 143222048
      nfiles: 15
    - path: src/train.py
      hash: md5
      md5: 83be84c37cd0bb2222bcb78a34a67763
      size: 2856
    params:
      params.yaml:
        train.data_path: data/train/raw
    outs:
    - path: log/train.log
      hash: md5
      md5: e35c2f463bba5d4f8f68cabc3d8d8526
      size: 338
    - path: model/improved_c45_model.joblib
      hash: md5
      md5: b6336da32d97b0ff1043a0d705c3f9d1
      size: 5017
  evaluate:
    cmd: uv run src/evaluate.py data/test/raw
    deps:
    - path: data/test/raw
      hash: md5
      md5: d1bea5bd78a93a985bba6933d5ee4727.dir
      size: 61306713
      nfiles: 7
    - path: model/improved_c45_model.joblib
      hash: md5
      md5: b6336da32d97b0ff1043a0d705c3f9d1
      size: 5017
    - path: src/evaluate.py
      hash: md5
      md5: baa506876dddbf6003bf4fa68727b404
      size: 3333
    params:
      params.yaml:
        evaluate.data_path: data/test/raw
    outs:
    - path: log/evaluate.log
      hash: md5
      md5: 7af9390e25b6fa82567709c8f257b937
      size: 132
  train_drl:
    cmd: uv run src/train_drl.py data/train/raw
    deps:
    - path: data/train/raw
      hash: md5
      md5: 0d3a44ba0fa58bfbd0c54533ae76194f.dir
      size: 143222048
      nfiles: 15
    - path: src/train_drl.py
      hash: md5
      md5: 99870dc636fa72a26e408d447b68189c
      size: 19218
    params:
      params.yaml:
        train.data_path: data/train/raw
        train_drl.batch_size: 16
        train_drl.eps_decay: 1000000
        train_drl.eps_end: 0.05
        train_drl.eps_start: 0.9
        train_drl.gamma: 0.99
        train_drl.include_category: true
        train_drl.lr: 0.001
        train_drl.memory_size: 100000
        train_drl.n_episodes: 100
        train_drl.port_dim: 32
        train_drl.protocol_dim: 8
        train_drl.sample_size: 100
        train_drl.tau: 0.005
        train_drl.update_target_steps: 200
    outs:
    - path: log/train_drl.log
      hash: md5
      md5: 2e5f96ebc56b31dd110529a39dc51c88
      size: 1339
    - path: log/train_result.log
      hash: md5
      md5: 432e0d434617a7b284b8ee2a1c00fc07
      size: 33910
    - path: model/drl_model.pth
      hash: md5
      md5: 35c3f42ba6f36f6ff7d99b5a7281513f
      size: 2457257
  evaluate_drl:
    cmd: uv run src/evaluate_drl.py data/test/raw
    deps:
    - path: data/test/raw
      hash: md5
      md5: d1bea5bd78a93a985bba6933d5ee4727.dir
      size: 61306713
      nfiles: 7
    - path: model/drl_model.pth
      hash: md5
      md5: 35c3f42ba6f36f6ff7d99b5a7281513f
      size: 2457257
    - path: src/evaluate_drl.py
      hash: md5
      md5: 231fe35a8038b1784a4ab78c459ca986
      size: 6790
    params:
      params.yaml:
        evaluate.data_path: data/test/raw
        evaluate.plot: true
        evaluate_drl.include_category: true
    outs:
    - path: evaluate/plots
      hash: md5
      md5: 5e72c98e4c46c370bac262b9fadfb8f1.dir
      size: 27124
      nfiles: 1
    - path: log/evaluate_drl.log
      hash: md5
      md5: ec5392ff7c58b09f666fb1ec6f15a1ac
      size: 242
